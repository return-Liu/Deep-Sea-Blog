import{d as S,u as E,b as N,e as w,c as T,f as m,a,w as n,g as L,h as t,i as R,r,o as f,j,k as y,v as F,l as I,m as _,n as C,p as M,E as d}from"./index-DaoAQrrJ.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Y={class:"login-container"},$={class:"login-card"},q={class:"login-links"},z=S({__name:"Login",setup(A){const c=R(),x=E(),k=N();let s=w({account:"",password:""}),l=w(!1),h=()=>s.value.account?s.value.password?!0:(d.error("请输入密码~"),!1):(d.error("请输入账号~"),!1),V=()=>{c.push("/register")},b=()=>{c.push("/resetpass")},g=async()=>{if(h())try{const i=await C.post("/auth/sign_in",{login:s.value.account,password:s.value.password});if(M.set("token",i.data.data.token),i.data.status){d.success("登录成功");const o=(await C.get("/users/me")).data.data;(o&&o.username===s.value.account||o.email===s.value.account)&&(x.setUser({id:o.id,nickname:o.nickname,avatar:o.avatar,sex:o.sex,birthday:o.birthday,introduce:o.introduce,constellation:o.constellation,nicknameColor:o.nicknameColor}),k.setUser(o.id),k.loadTheme(),c.push("/home"))}}catch{d.error("用户不存在,请注册账号")}};return(i,e)=>{const o=r("el-input"),p=r("el-form-item"),U=r("el-icon"),B=r("el-button"),K=r("el-form"),v=r("el-link");return f(),T("div",Y,[m("div",$,[e[6]||(e[6]=m("h2",{class:"login-title"},"逸刻时光-YiKe登录",-1)),a(K,{onKeydown:L(t(g),["enter"]),model:t(s)},{default:n(()=>[a(p,{label:"账号"},{default:n(()=>[a(o,{class:"login-input",modelValue:t(s).account,"onUpdate:modelValue":e[0]||(e[0]=u=>t(s).account=u),placeholder:"请输入账号/邮箱"},null,8,["modelValue"])]),_:1}),a(p,{label:"密码"},{default:n(()=>[a(o,{type:t(l)?"text":"password",class:"login-input",modelValue:t(s).password,"onUpdate:modelValue":e[2]||(e[2]=u=>t(s).password=u),placeholder:"请输入密码"},{suffix:n(()=>[a(U,{class:"cursor-pointer",onClick:e[1]||(e[1]=u=>j(l)?l.value=!t(l):l=!t(l))},{default:n(()=>[t(l)?(f(),y(t(F),{key:0})):(f(),y(t(I),{key:1}))]),_:1})]),_:1},8,["type","modelValue"])]),_:1}),a(p,null,{default:n(()=>[a(B,{type:"primary",onClick:t(g),class:"login-button"},{default:n(()=>e[3]||(e[3]=[_(" 登录 ")])),_:1},8,["onClick"])]),_:1})]),_:1},8,["onKeydown","model"]),m("div",q,[a(v,{type:"primary",onClick:t(b)},{default:n(()=>e[4]||(e[4]=[_("忘记密码")])),_:1},8,["onClick"]),a(v,{type:"primary",onClick:t(V)},{default:n(()=>e[5]||(e[5]=[_("新用户注册")])),_:1},8,["onClick"])])])])}}}),H=P(z,[["__scopeId","data-v-5201612f"]]);export{H as default};
