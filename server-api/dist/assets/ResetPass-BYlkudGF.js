import{d as V,e as i,c as d,f as s,s as E,t as m,x as w,y as u,z as v,i as I,n as g,E as a,o as c}from"./index-BDg1WjkS.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";const D={class:"forget-password-container"},B={class:"forget-password-card"},N={class:"form-group"},R={key:0,class:"error"},U={class:"form-group"},K=["disabled"],T={key:0,class:"error"},Y={class:"form-group"},z={key:0,class:"error"},$=["disabled"],j={key:0,class:"success"},q={key:1,class:"error"},A=V({__name:"ResetPass",setup(F){const b=I(),l=i(""),p=i(""),n=i(""),t=i({email:"",verificationCode:"",newPassword:""}),_=i(""),y=i(""),f=i(!1),C=i(!1),P=()=>l.value?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l.value)?(t.value.email="",!0):(a.error("邮箱格式不正确"),!1):(a.error("邮箱不能为空"),!1),h=()=>p.value?(t.value.verificationCode="",!0):(a.error("验证码不能为空"),!1),S=()=>n.value?n.value.length<6||n.value.length>45?(t.value.newPassword="新密码长度在6到45个字符之间",!1):(t.value.newPassword="",!0):(t.value.newPassword="新密码不能为空",!1),k=async()=>{if(P()){f.value=!0;try{const o=await g.post("/email/getemail",{email:l.value}),{code:e}=o.data.data;sessionStorage.setItem("code",e),a.success("验证码发送成功")}catch{a.error("发送验证码失败")}}},x=async()=>{if(!(!P()||!h()||!S())){try{if(await g.post("/email/checkemail",{email:l.value,code:sessionStorage.getItem("code")}),p.value!==sessionStorage.getItem("code")){a.error("验证码错误,请你输入正确的验证码");return}}catch(o){if(o.response&&o.response.data){const e=o.response.data;e.errors&&e.errors.forEach(r=>{a.error(r)})}}try{await g.post("/email/resetpassword",{email:l.value,code:sessionStorage.getItem("code"),password:n.value,currentPassword:n.value}),a.success("重置密码成功，请重新登录"),sessionStorage.removeItem("code"),setTimeout(()=>{b.push("/login")},5e3)}catch(o){if(o.response&&o.response.data){const e=o.response.data;e.errors&&e.errors.forEach(r=>{a.error(r)})}}}};return(o,e)=>(c(),d("div",D,[s("div",B,[e[6]||(e[6]=s("h2",{class:"reset-title"},"逸刻时光-YiKe重置密码",-1)),s("form",{onSubmit:E(x,["prevent"])},[s("div",N,[e[3]||(e[3]=s("label",{for:"email"},"邮箱",-1)),m(s("input",{type:"email",id:"email","onUpdate:modelValue":e[0]||(e[0]=r=>l.value=r),placeholder:"请输入您的邮箱"},null,512),[[w,l.value]]),t.value.email?(c(),d("p",R,u(t.value.email),1)):v("",!0)]),s("div",U,[e[4]||(e[4]=s("label",{for:"verificationCode"},"验证码",-1)),m(s("input",{type:"text",id:"verificationCode","onUpdate:modelValue":e[1]||(e[1]=r=>p.value=r),placeholder:"请输入验证码"},null,512),[[w,p.value]]),s("button",{type:"button",onClick:k,disabled:f.value},u(f.value?"发送中...":"发送验证码"),9,K),t.value.verificationCode?(c(),d("p",T,u(t.value.verificationCode),1)):v("",!0)]),s("div",Y,[e[5]||(e[5]=s("label",{for:"newPassword"},"新密码",-1)),m(s("input",{type:"password",id:"newPassword","onUpdate:modelValue":e[2]||(e[2]=r=>n.value=r),placeholder:"请输入新密码"},null,512),[[w,n.value]]),t.value.newPassword?(c(),d("p",z,u(t.value.newPassword),1)):v("",!0)]),s("button",{type:"submit",disabled:C.value},"提交",8,$),_.value?(c(),d("p",j,u(_.value),1)):v("",!0),y.value?(c(),d("p",q,u(y.value),1)):v("",!0)],32),e[7]||(e[7]=s("p",{class:"register-tip"}," 请注意，此重置密码功能仅限于逸刻时光-YiKe网站的测试和学习用途。请确保您输入的邮箱地址是正确的，并妥善保护您的个人隐私和个人信息，以避免不必要的风险。谢谢您的配合。 ",-1))])]))}}),J=M(A,[["__scopeId","data-v-d26686f6"]]);export{J as default};
