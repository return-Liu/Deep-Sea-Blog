import{d as w,u as F,e as m,B as S,c as l,f as a,J as N,K as C,h as I,a as y,w as z,n as d,E as x,r as L,L as D,o as i,s as M,x as _}from"./index-DaoAQrrJ.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";const $={class:"local-resources"},K={class:"local-resources-content"},P={key:0,class:"grid-container"},U=["title"],V=["alt"],A={class:"resource-info"},G={class:"file-size"},J=["title"],b={class:"resource-info"},j={key:1,class:"empty-state"},q=w({__name:"LocalResources",setup(H){const v=F().user,o=m([]),n=m(0),r=m(null);function B(){d.get("/users/me").then(s=>{r.value=s.data.data.id,k()}).catch(s=>{console.log("获取用户信息失败"),x.error("获取用户信息失败，请稍后再试",s)})}async function k(){try{const[s,t,c]=await Promise.all([d.get("/admin/article",{params:{userId:r.value}}),d.get("/admin/photography",{params:{userId:r.value}}),d.get("/admin/note",{params:{userId:r.value}})]);s.data.data.articles.forEach(e=>{e.userId===r.value&&(o.value.push({userId:e.userId,image:e.image,size:e.size}),n.value+=e.size)}),t.data.data.photography.forEach(e=>{e.userId===r.value&&(o.value.push({userId:e.userId,image:e.image,size:e.size}),n.value+=e.size)}),c.data.data.notes.forEach(e=>{e.userId===r.value&&(o.value.push({userId:e.userId,image:e.image,size:e.size}),n.value+=e.size)})}catch(s){console.error("获取数据失败:",s),x.error("获取数据失败，请稍后再试")}}function g(s){return s<1024?s+" B":s<1024*1024?(s/1024).toFixed(2)+" KB":s<1024*1024*1024?(s/(1024*1024)).toFixed(2)+" MB":(s/(1024*1024*1024)).toFixed(2)+" GB"}function E(s){const t=s.split("/").pop();return t?t.split("?")[0]:"未知文件名"}return S(()=>{B()}),(s,t)=>{var p;const c=L("el-card"),h=D("lazy");return i(),l("div",$,[t[2]||(t[2]=a("div",{class:"local-resources-header"},[a("h2",null,"本地文件"),a("p",{class:"local-resources-description"}," 你可以在这里查看你的所有本地文件。 ")],-1)),a("div",K,[o.value.length>0?(i(),l("div",P,[(i(!0),l(N,null,C(o.value,(u,e)=>{var f;return i(),l("div",{class:"grid-item",title:`${((f=I(v))==null?void 0:f.nickname)||"默认用户"}的本地文件`,key:e},[y(c,{shadow:"hover",class:"resource-card"},{default:z(()=>[M(a("img",{alt:`Image ${e+1}`,class:"resource-image"},null,8,V),[[h,u.image]]),a("div",A,[a("p",null,_(E(u.image)),1),a("p",G,_(g(u.size)),1)])]),_:2},1024)],8,U)}),128)),a("div",{class:"grid-item",title:`${((p=I(v))==null?void 0:p.nickname)||"默认用户"}的总文件大小`},[y(c,{shadow:"hover",class:"resource-card total-size-card"},{default:z(()=>[a("div",b,[t[0]||(t[0]=a("h2",null,"总文件大小",-1)),a("p",null,_(g(n.value)),1)])]),_:1})],8,J)])):(i(),l("div",j,t[1]||(t[1]=[a("p",null,"你还没有上传任何文件,",-1),a("p",null,"你可以在进行操作。",-1)])))])])}}}),W=R(q,[["__scopeId","data-v-a645c334"]]);export{W as default};
