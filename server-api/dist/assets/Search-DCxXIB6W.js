import{d as N,i as T,o as t,c as s,f as d,y as m,z as f,e as u,P as K,A as L,a as i,h as c,j as V,g as j,w as b,U as w,V as C,n as I,r as h,m as x,k as E}from"./index-BDg1WjkS.js";import{f as F,z as M}from"./zh-CN-ZPh2jKaf.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";const P={class:"result-item"},Q={class:"result-image"},q=["src","alt"],G={class:"result-details"},H={key:0,class:"result-title"},J={key:1,class:"result-label"},O={class:"result-date"},W=N({__name:"ResultItem",props:{item:{}},setup(S){T();const r=e=>F(new Date(e),{addSuffix:!0,locale:M});return(e,n)=>(t(),s("div",P,[d("div",Q,[d("img",{src:e.item.image,alt:e.item.title,class:"result-image"},null,8,q)]),d("div",G,[e.item.title?(t(),s("h4",H,m(e.item.title),1)):f("",!0),e.item.label?(t(),s("p",J,m(e.item.label),1)):f("",!0),d("p",O,m(r(e.item.createdAt)),1)])]))}}),X=$(W,[["__scopeId","data-v-d76ddade"]]),Y={class:"search-container"},Z={key:0,class:"loading"},ee={key:1,class:"error"},te={key:2},se={class:"section-title"},ae={key:0,class:"result-grid"},le={key:1,class:"no-results"},oe=N({__name:"Search",setup(S){let r=u(""),e=u("all"),n=u(null),v=u(!1),_=u("");const B=K(()=>{if(!n.value)return[];const a=[{title:"博客文章",items:n.value.articles.list||[]},{title:"摄影图库",items:n.value.photographies.list||[]},{title:"随笔随记",items:n.value.notes.list||[]}];return e.value!=="all"?a.filter(o=>o.title.toLowerCase()===e.value):a});let y=u(null);function D(){I.get("/users/me",{}).then(a=>{y.value=a.data.data.id}).catch(a=>{console.log("获取用户信息失败")})}const g=async()=>{v.value=!0,_.value="";try{const a=await I.get("/search/search",{params:{keyword:r.value,type:e.value,userId:y.value}});n.value=a.data.data}catch(a){_.value="搜索失败，请重试",console.error("搜索失败:",a)}finally{v.value=!1}};return L(()=>{D()}),(a,o)=>{const R=h("el-input"),p=h("el-option"),U=h("el-select"),z=h("el-button");return t(),s("div",Y,[i(R,{modelValue:c(r),"onUpdate:modelValue":o[0]||(o[0]=l=>V(r)?r.value=l:r=l),placeholder:"请输入搜索关键词",onKeyup:j(g,["enter"]),class:"search-input"},null,8,["modelValue"]),i(U,{modelValue:c(e),"onUpdate:modelValue":o[1]||(o[1]=l=>V(e)?e.value=l:e=l),placeholder:"选择搜索类型",class:"search-type"},{default:b(()=>[i(p,{label:"全部",value:"all"}),i(p,{label:"博客文章",value:"articles"}),i(p,{label:"摄影图库",value:"photographies"}),i(p,{label:"随笔随记",value:"notes"})]),_:1},8,["modelValue"]),i(z,{type:"primary",onClick:g,class:"search-button"},{default:b(()=>o[2]||(o[2]=[x("搜索")])),_:1}),c(v)?(t(),s("div",Z,"加载中...")):c(_)?(t(),s("div",ee,m(c(_)),1)):c(n)?(t(),s("div",te,[(t(!0),s(w,null,C(B.value,(l,A)=>(t(),s("section",{key:A},[d("h3",se,m(l.title),1),l.items.length?(t(),s("div",ae,[(t(!0),s(w,null,C(l.items,k=>(t(),E(X,{key:k.id,item:k},null,8,["item"]))),128))])):(t(),s("div",le,"没有找到相关结果"))]))),128))])):f("",!0)])}}}),ue=$(oe,[["__scopeId","data-v-5a1f182e"]]);export{ue as default};
