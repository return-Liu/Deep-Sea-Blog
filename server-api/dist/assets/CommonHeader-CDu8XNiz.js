import{e as d,u as ge,A as ye,B as he,a3 as ke,a4 as we,a5 as Ce,n as ie,E as K,i as xe,d as Se,c as v,a as n,w as l,h as t,j as x,r,L as Ve,o as u,f as s,s as P,t as Me,g as be,a2 as ze,J as re,K as de,k as ue,x as b,y as z,P as Ue,m as O}from"./index-DaoAQrrJ.js";import{_ as Ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";function Be(){var J;const f=xe(),h=d(""),X=d(!1),_=d(!1),U=ge(),k=ye(()=>U.user),c=d(!1),$=d("rtl"),Q=d("30%"),A=d(!1),S=d([]),V=d(!1),w=d({title:"",content:"",userId:((J=k.value)==null?void 0:J.id)||4}),B=()=>{c.value=!0};async function M(){try{const N=(await ie.get("/admin/update")).data.data.updates;S.value=N.map(T=>({...T,formattedCreatedAt:new Date(T.createdAt).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})}))}catch(e){console.error("获取更新信息失败",e),K.error("获取更新信息失败")}}async function I(){var e;try{await ie.post("/admin/update",w.value),M(),w.value={title:"",content:"",userId:((e=k.value)==null?void 0:e.id)||4},K.success("新增更新信息成功"),c.value=!1,V.value=!1}catch{K.error("新增更新信息失败")}}he(()=>{M()});const L=ke([{name:"由于异常问题,暂时无法完成相关功能"},{name:"目前已排查所有的问题，请耐心等待"}]),D=e=>{h.value=e.target.value},R=()=>{_.value=!0},W=()=>{h.value||setTimeout(()=>{_.value=!1},8e3)},j=()=>{_.value=!0},p=()=>{_.value=!1},m=()=>{f.push({path:"/setting/personals"})},g=()=>{f.push({path:"/setting/securitys"})},i=()=>{f.push({path:"/setting/likes"})},C=()=>{f.push({path:"/setting/modes"})},q=()=>{f.push({path:"/setting/layouts"})};async function E(){try{f.push({name:"search",query:{keyword:h.value}})}catch{K.error("搜索失败,请稍后再试")}}return{Search:we,isSearchActive:X,Message:Ce,openSettings:C,goToLikedArticles:i,searchQuery:h,isScrollingPaused:_,text:L,handleInput:D,changeSetting:m,viewAccountSecurity:g,handleFocus:R,handleBlur:W,handleMouseEnter:j,handleMouseLeave:p,viewMessage:B,handleSearch:E,direction:$,size:Q,addUpdate:I,showDialog:V,showInfoCard:A,newUpdate:w,user:k,drawerVisible:c,updates:S,viewWall:q}}const Ie={class:"search-box"},Le={class:"search-input"},De={class:"scrolling-text"},Ee={class:"carousel-text"},Ne={class:"search-icon"},Te={key:0,class:"avatar-box"},Fe=["title"],He={key:1,class:"info-card"},Ke={class:"info-card-header"},Pe={class:"info-card-avatar"},$e=["title"],Qe=["title"],Re={class:"info-card-content"},We={class:"info-card-item"},je={class:"drawer-content"},qe={class:"update-content"},Je={class:"update-email"},Ge={class:"update-description"},Oe={class:"update-time-text"},Xe=Se({__name:"CommonHeader",setup(f){let{Search:h,isSearchActive:X,Message:_,openSettings:U,goToLikedArticles:k,searchQuery:c,isScrollingPaused:$,text:Q,handleInput:A,changeSetting:S,viewAccountSecurity:V,handleFocus:w,handleBlur:B,handleMouseEnter:M,handleMouseLeave:I,viewMessage:L,handleSearch:D,direction:R,size:W,addUpdate:j,showDialog:p,showInfoCard:m,newUpdate:g,user:i,drawerVisible:C,updates:q,viewWall:E}=Be();return(J,e)=>{const N=r("el-carousel-item"),T=r("el-carousel"),F=r("el-icon"),ce=r("el-header"),pe=r("mail"),me=r("clock"),Y=r("el-button"),ve=r("el-drawer"),Z=r("el-input"),G=r("el-form-item"),fe=r("el-form"),_e=r("el-dialog"),ee=Ve("lazy");return u(),v("div",null,[n(ce,null,{default:l(()=>{var a,y,H,te,oe,se,ne,ae,le;return[s("div",Ie,[s("div",Le,[P(s("input",{type:"text",class:"search-input-text",onInput:e[0]||(e[0]=(...o)=>t(A)&&t(A)(...o)),onFocus:e[1]||(e[1]=(...o)=>t(w)&&t(w)(...o)),onBlur:e[2]||(e[2]=(...o)=>t(B)&&t(B)(...o)),onMouseenter:e[3]||(e[3]=(...o)=>t(M)&&t(M)(...o)),onMouseleave:e[4]||(e[4]=(...o)=>t(I)&&t(I)(...o)),"onUpdate:modelValue":e[5]||(e[5]=o=>x(c)?c.value=o:c=o),onKeyup:e[6]||(e[6]=be((...o)=>t(D)&&t(D)(...o),["enter"]))},null,544),[[Me,t(c)]]),P(s("div",De,[n(T,{direction:"vertical",autoplay:!t($),interval:7e3},{default:l(()=>[(u(!0),v(re,null,de(t(Q),o=>(u(),ue(N,{key:o.name},{default:l(()=>[s("h3",Ee,b(o.name),1)]),_:2},1024))),128))]),_:1},8,["autoplay"])],512),[[ze,!t(c)]])]),s("div",Ne,[n(F,{size:15,color:"#000"},{default:l(()=>[n(t(h))]),_:1})])]),t(i)?(u(),v("div",Te,[s("div",{class:"email-box",title:"系统信息",onClick:e[7]||(e[7]=(...o)=>t(L)&&t(L)(...o))},[n(F,{size:30,color:"#0078d4"},{default:l(()=>[n(t(_))]),_:1})]),s("div",{class:"avatar-img",onMouseenter:e[13]||(e[13]=o=>x(m)?m.value=!0:m=!0),onMouseleave:e[14]||(e[14]=o=>x(m)?m.value=!1:m=!1)},[(a=t(i))!=null&&a.avatar?P((u(),v("img",{key:0,alt:"头像",title:`${((y=t(i))==null?void 0:y.nickname)||"默认用户"}的头像`},null,8,Fe)),[[ee,(H=t(i))==null?void 0:H.avatar]]):z("",!0),t(m)?(u(),v("div",He,[s("div",Ke,[s("div",Pe,[(te=t(i))!=null&&te.avatar?P((u(),v("img",{key:0,alt:"头像",title:`${((oe=t(i))==null?void 0:oe.nickname)||"默认用户"}的头像`},null,8,$e)),[[ee,(se=t(i))==null?void 0:se.avatar]]):z("",!0)]),s("div",{class:"info-card-name",title:`${((ne=t(i))==null?void 0:ne.nickname)||"默认用户"}的昵称`,style:Ue({color:((ae=t(i))==null?void 0:ae.nicknameColor)||"#000"})},b((le=t(i))==null?void 0:le.nickname),13,Qe)]),s("div",Re,[s("div",We,[s("p",{onClick:e[8]||(e[8]=(...o)=>t(S)&&t(S)(...o))},"我的资料"),e[20]||(e[20]=s("span",null,null,-1)),s("p",{onClick:e[9]||(e[9]=(...o)=>t(V)&&t(V)(...o))},"账号安全"),e[21]||(e[21]=s("span",null,null,-1)),s("p",{onClick:e[10]||(e[10]=(...o)=>t(k)&&t(k)(...o))},"我的点赞"),e[22]||(e[22]=s("span",null,null,-1)),s("p",{onClick:e[11]||(e[11]=(...o)=>t(U)&&t(U)(...o))},"模式选择"),s("p",{onClick:e[12]||(e[12]=(...o)=>t(E)&&t(E)(...o))},"界面布局")])])])):z("",!0)],32)])):z("",!0)]}),_:1}),n(ve,{title:"系统信息",modelValue:t(C),"onUpdate:modelValue":e[16]||(e[16]=a=>x(C)?C.value=a:C=a),direction:t(R),"close-on-click-modal":!1,size:t(W)},{default:l(()=>{var a;return[s("div",je,[(u(!0),v(re,null,de(t(q),(y,H)=>(u(),v("div",{key:H,class:"update-item"},[s("div",qe,[s("p",Je,[n(F,{size:16,color:"#606266"},{default:l(()=>[n(pe)]),_:1}),O(" "+b(y.title),1)]),s("p",Ge,b(y.content),1),s("p",Oe,[n(F,{size:16,color:"#909399"},{default:l(()=>[n(me)]),_:1}),O(" 更新时间: "+b(y.formattedCreatedAt),1)])])]))),128))]),((a=t(i))==null?void 0:a.id)===4?(u(),ue(Y,{key:0,type:"primary",class:"drawer-close-button",icon:"el-icon-plus",onClick:e[15]||(e[15]=y=>x(p)?p.value=!0:p=!0)},{default:l(()=>e[23]||(e[23]=[s("p",null,"+",-1)])),_:1})):z("",!0)]}),_:1},8,["modelValue","direction","size"]),n(_e,{title:"新增更新信息",modelValue:t(p),"onUpdate:modelValue":e[19]||(e[19]=a=>x(p)?p.value=a:p=a),width:"50%"},{default:l(()=>[n(fe,{model:t(g),"label-width":"100px"},{default:l(()=>[n(G,{label:"标题"},{default:l(()=>[n(Z,{modelValue:t(g).title,"onUpdate:modelValue":e[17]||(e[17]=a=>t(g).title=a)},null,8,["modelValue"])]),_:1}),n(G,{label:"更新内容"},{default:l(()=>[n(Z,{type:"textarea",modelValue:t(g).content,"onUpdate:modelValue":e[18]||(e[18]=a=>t(g).content=a)},null,8,["modelValue"])]),_:1}),n(G,null,{default:l(()=>[n(Y,{type:"primary",onClick:t(j)},{default:l(()=>e[24]||(e[24]=[O("新增")])),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),et=Ae(Xe,[["__scopeId","data-v-6f5170b6"]]);export{et as default};
