import{e as f,A as te,B as re,C as ue,D as ce,E as g,n as k,F as O,G as pe,H as me,I as ge,i as fe,d as ve,c as N,f as t,a as s,w as a,J as _e,K as ye,h as l,j as be,r as u,L as he,o as y,m as B,x,k as D,M as we,N as le,y as $,s as ke}from"./index-DaoAQrrJ.js";import{_ as Ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";function Ve(L){const T=fe(),b=f(null),w=f(!1),c=f("essay"),U=f(),m=f(""),C=f(0),A=f(0),F=f(0);let z=f(!1);const d=f({title:"",content:"",image:"",label:"",size:0}),{totalVisits:P,todayVisits:E}=ce;let I=()=>{T.push("/wall/messages")},h=()=>{window.open("https://mm.edrawsoft.cn/app/editor/1p92bJ75iWL3QEs8d6LCa2fVNl51BUXV?ivt=IS5CWemzHJk8s76zHCAj6TXZHmV2Nlje001&page=8889934692","_blank")},q=()=>{window.open("https://yike.design/","_blank")},R=()=>{window.open("https://github.com/ecaps1038/yike-design-dev","_blank")},G=()=>{T.push("/download"),console.log(1)};const S=()=>{L.value?L.value.submit():(console.error("uploadRef 未正确赋值"),g.error("上传组件未正确初始化，请稍后再试"))},J=(o,r)=>{z.value=r.length>0};function W(){k.get("/users/me").then(o=>{b.value=o.data.data.id,v()}).catch(o=>{console.error("获取用户信息失败:",o)})}const X=te(()=>({essay:"新增博客文章",photography:"新增摄影图库",notes:"新增随笔随记"})[c.value]),K=te(()=>{const o={};return c.value!=="photography"&&(o.title=[{required:!0,message:"请输入标题",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],o.image=[{required:!0,message:"请上传图片",trigger:"change"}],o.content=[{required:!0,message:"请输入内容",trigger:"blur"},{min:5,max:500,message:"长度在 5 到 500 个字符",trigger:"blur"}]),c.value==="essay"&&(o.label=[{required:!0,message:"请输入标签",trigger:"blur"}]),o}),Q=o=>{const i=["image/jpeg","image/png","image/webp","image/gif"].includes(o.type),_=o.size/1024/1024<2;return i||g.error("上传图片只能是 JPG 或 PNG 或 WEBP 或 GIF 格式!"),_||g.error("上传图片大小不能超过 2MB!"),b.value?(d.value.size=o.size,j(!0),i&&_):(g.error("用户ID未找到，请重新登录"),!1)},Y=(o,r)=>{m.value=`${O}/image/${o.data.image}`,d.value.image=m.value,g.success("图片上传成功"),L.value.clearFiles(),z.value=!1},j=async(o=!1)=>{try{if(!m.value)return;const r=m.value.split("/");if(r.length===0){console.warn("imageUrl 格式不正确:",m.value);return}const i=r.pop();if(!i){console.warn("无法从 imageUrl 提取图片名称:",m.value);return}await k.delete(`${O}/admin/upload/image/${i}`),m.value="",o?g.success("旧图片已删除, 已重新上传新图片"):g.success("已删除未使用的图片,如需重新上传,请点击上传按钮")}catch(r){console.error("删除图片失败:",r),g.error("删除失败")}};function ee(o){c.value=o,w.value=!0}function e(){var o;j(!1),w.value=!1,d.value={title:"",content:"",label:"",image:"",size:0},(o=U.value)==null||o.resetFields()}async function p(){var o,r;try{await((o=U.value)==null?void 0:o.validate());let i={image:d.value.image,userId:b.value,size:d.value.size};c.value==="essay"?(i.title=d.value.title,i.content=d.value.content,i.label=d.value.label):c.value==="notes"&&(i.title=d.value.title,i.content=d.value.content);let _="";c.value==="essay"?(await k.post("/admin/article",i),_="创建博客文章成功"):c.value==="photography"?(await k.post("/admin/photography",i),_="创建摄影作品成功"):c.value==="notes"&&(await k.post("/admin/note",i),_="创建随笔随记成功"),w.value=!1,d.value={title:"",content:"",label:"",image:"",size:0},v(),g.success(_)}catch(i){console.error("创建失败",i),g.error("创建失败，请重试")}finally{(r=U.value)==null||r.resetFields()}}async function v(){try{const[o,r,i]=await Promise.all([k.get("/admin/article",{params:{userId:b.value}}),k.get("/admin/photography",{params:{userId:b.value}}),k.get("/admin/note",{params:{userId:b.value}})]);C.value=o.data.data.pagination.total,A.value=r.data.data.pagination.total,F.value=i.data.data.pagination.total}catch(o){console.error("获取数量失败",o),g.error("获取数量失败，请稍后再试")}}return re(()=>{v(),W()}),{wall:I,designdoc:h,official:q,github:R,download:G,ArrowRight:ue,todayVisits:E,totalVisits:P,submitUpload:S,handleSuccess:Y,contentTypes:[{type:"essay",title:"博客文章",description:"记录生活点滴",icon:pe,iconColor:"text-primary",buttonType:"primary",countLabel:"篇文章"},{type:"photography",title:"摄影图库",description:"定格美好瞬间",icon:me,iconColor:"text-success",buttonType:"success",countLabel:"张照片"},{type:"notes",title:"随笔随记",description:"随想随心记录",icon:ge,iconColor:"text-warning",buttonType:"warning",countLabel:"篇随笔"}],handleSubmit:p,handleClose:e,getTotalCount:o=>({essay:C.value,photography:A.value,notes:F.value})[o],handleAdd:ee,beforeUpload:Q,handleChange:J,currentType:c,imageUrl:m,showUploadButton:z,dialogTitle:X,dialogVisible:w,formData:d,rules:K,userId:b}}const xe={class:"home"},Te={class:"main-container"},Ue={class:"chat-room-card gradient-background"},ze={class:"title"},Ie={class:"download"},Ne={class:"message-wall-card gradient-background"},Be={class:"title"},De={class:"Wall-doc"},Le={class:"yike-ui-card gradient-background"},Ae={class:"title"},Fe={class:"action-buttons"},Pe={class:"statistics-container"},Re={class:"stats-cards"},Se={class:"card-header"},je={class:"stat-value"},He={class:"card-header"},Me={class:"stat-value"},$e={class:"content-cards"},Ee={class:"content-header"},qe={class:"content-info"},Ge={class:"content-text"},Je={class:"content-count"},We={class:"count-number"},Xe={class:"count-label"},Ke={class:"upload-container"},Qe={key:0,class:"uploaded-image"},Ye={key:1,class:"upload-placeholder"},Ze={class:"dialog-footer"},Oe=ve({__name:"Home",setup(L){const T=f(null),{wall:b,designdoc:w,official:c,github:U,download:m,ArrowRight:C,todayVisits:A,totalVisits:F,contentTypes:z,currentType:d,imageUrl:P,showUploadButton:E,dialogVisible:I,formData:h,userId:q,submitUpload:R,handleSuccess:G,handleSubmit:S,handleClose:J,getTotalCount:W,handleAdd:X,beforeUpload:K,handleChange:Q,dialogTitle:Y,rules:j}=Ve(T);return(ee,e)=>{const p=u("el-icon"),v=u("el-card"),H=u("el-carousel-item"),V=u("el-button"),o=u("el-carousel"),r=u("View"),i=u("Timer"),_=u("Plus"),Z=u("el-input"),M=u("el-form-item"),se=u("el-upload"),oe=u("el-form"),ae=u("Upload"),ne=u("SuccessFilled"),ie=u("el-dialog"),de=he("lazy");return y(),N("div",xe,[t("div",Te,[s(o,{class:"custom-carousel",interval:5e3,"indicator-position":"outside",width:"100%",height:"400px"},{default:a(()=>[s(H,null,{default:a(()=>[t("div",Ue,[s(v,{shadow:"always",class:"full-width-card chat-room-card-content"},{default:a(()=>[t("div",ze,[e[9]||(e[9]=t("h1",null,"Vue+Node.js",-1)),e[10]||(e[10]=t("h1",{style:{width:"350px"}},"0到1实现即时通讯聊天室",-1)),e[11]||(e[11]=t("p",{style:{"margin-top":"20px"}},"单聊 群聊",-1)),e[12]||(e[12]=t("p",null,"可发送文字 表情 图片 语音 位置....",-1)),e[13]||(e[13]=t("div",{class:"text-box"},[t("p",null," 如您对这个应用感兴趣,欢迎下载使用,当然对于需要查看设计稿和下载切图的同学,点击下方对应路口查阅。 ")],-1)),t("div",Ie,[t("span",{class:"down-load",onClick:e[0]||(e[0]=(...n)=>l(m)&&l(m)(...n))},"下载应用"),t("button",{onClick:e[1]||(e[1]=(...n)=>l(w)&&l(w)(...n)),class:"design-doc"},[e[8]||(e[8]=B(" 访问设计稿原型 ")),s(p,{size:10,color:"skyblue"},{default:a(()=>[s(l(C))]),_:1})])])])]),_:1})])]),_:1}),s(H,null,{default:a(()=>[t("div",Ne,[s(v,{shadow:"always",class:"full-width-card message-wall-content"},{default:a(()=>[t("div",Be,[e[16]||(e[16]=t("h1",null,"一刻时光留言墙,留下你的足迹",-1)),e[17]||(e[17]=t("p",{style:{"margin-top":"20px"}},"当下的心情,就让他留在当下吧",-1)),e[18]||(e[18]=t("div",{class:"text-box"},[t("p",null," 如您对留言墙感兴趣，欢迎来留言。需要查看设计稿和下载切图的同学，点击下方设计稿入口查阅 ")],-1)),t("div",De,[s(V,{class:"wall",onClick:l(b)},{default:a(()=>e[14]||(e[14]=[B("去留言")])),_:1},8,["onClick"]),s(V,{class:"design-doc",onClick:l(w)},{default:a(()=>[e[15]||(e[15]=B("访问设计稿原型 ")),s(p,{size:10,color:"skyblue"},{default:a(()=>[s(l(C))]),_:1})]),_:1},8,["onClick"])])])]),_:1})])]),_:1}),s(H,null,{default:a(()=>[t("div",Le,[s(v,{shadow:"always",class:"full-width-card yike-ui-card-content"},{default:a(()=>[t("div",Ae,[e[21]||(e[21]=t("h1",null,"Yike Design",-1)),e[22]||(e[22]=t("p",null,"Vue3+Ts+Less 开发的前端UI框架",-1)),e[23]||(e[23]=t("div",{class:"text-box"},[t("p",{style:{"margin-top":"50px"}}," 一套简洁干净的前端UI框架。从源码出发，提供便捷的源码配置，单个组件自由组合成专属UI库，为服务于交互与展示。 ")],-1)),t("div",Fe,[s(V,{class:"official-address",onClick:l(c)},{default:a(()=>e[19]||(e[19]=[B("官方地址")])),_:1},8,["onClick"]),s(V,{onClick:l(U),class:"design-doc"},{default:a(()=>[e[20]||(e[20]=B(" github仓库 ")),s(p,{size:10,color:"skyblue"},{default:a(()=>[s(l(C))]),_:1})]),_:1},8,["onClick"])])])]),_:1})])]),_:1})]),_:1}),t("div",Pe,[e[26]||(e[26]=t("h2",{class:"section-title"},"数据模块",-1)),t("div",Re,[s(v,{class:"stat-card total-visits"},{header:a(()=>[t("div",Se,[s(p,null,{default:a(()=>[s(r)]),_:1}),e[24]||(e[24]=t("span",null,"总访问量",-1))])]),default:a(()=>[t("div",je,x(l(F)),1)]),_:1}),s(v,{class:"stat-card today-visits"},{header:a(()=>[t("div",He,[s(p,null,{default:a(()=>[s(i)]),_:1}),e[25]||(e[25]=t("span",null,"今日访问",-1))])]),default:a(()=>[t("div",Me,x(l(A)),1)]),_:1})]),t("div",$e,[(y(!0),N(_e,null,ye(l(z),n=>(y(),D(v,{key:n.type,class:le(["content-card",n.type]),onClick:et=>l(X)(n.type)},{default:a(()=>[t("div",Ee,[t("div",qe,[s(p,{size:24,class:le(n.iconColor)},{default:a(()=>[(y(),D(we(n.icon)))]),_:2},1032,["class"]),t("div",Ge,[t("h3",null,x(n.title),1),t("p",null,x(n.description),1)])]),s(V,{type:n.buttonType,circle:"",class:"add-button"},{default:a(()=>[s(p,null,{default:a(()=>[s(_)]),_:1})]),_:2},1032,["type"])]),t("div",Je,[t("span",We,x(l(W)(n.type)),1),t("span",Xe,x(n.countLabel),1)])]),_:2},1032,["class","onClick"]))),128))])])]),s(ie,{modelValue:l(I),"onUpdate:modelValue":e[7]||(e[7]=n=>be(I)?I.value=n:null),title:l(Y),width:"50%","before-close":l(J),"close-on-click-modal":!1},{footer:a(()=>[t("span",Ze,[l(E)?(y(),N("div",{key:0,class:"avatar-upload",onClick:e[5]||(e[5]=(...n)=>l(R)&&l(R)(...n))},[s(p,null,{default:a(()=>[s(ae)]),_:1}),e[28]||(e[28]=t("span",null,"上传",-1))])):$("",!0),t("div",{class:"avatar-upload",type:"primary",onClick:e[6]||(e[6]=(...n)=>l(S)&&l(S)(...n))},[s(p,null,{default:a(()=>[s(ne)]),_:1}),e[29]||(e[29]=t("span",null,"保存",-1))])])]),default:a(()=>[s(oe,{ref:"formRef",model:l(h),rules:l(j),"label-width":"80px",class:"add-form"},{default:a(()=>[l(d)!=="photography"?(y(),D(M,{key:0,label:"标题",prop:"title"},{default:a(()=>[s(Z,{modelValue:l(h).title,"onUpdate:modelValue":e[2]||(e[2]=n=>l(h).title=n),placeholder:"请输入标题"},null,8,["modelValue"])]),_:1})):$("",!0),l(d)!=="photography"?(y(),D(M,{key:1,label:"内容",prop:"content"},{default:a(()=>[s(Z,{modelValue:l(h).content,"onUpdate:modelValue":e[3]||(e[3]=n=>l(h).content=n),type:"textarea",rows:4,placeholder:"请输入内容"},null,8,["modelValue"])]),_:1})):$("",!0),s(M,{label:"上传图库",prop:"image"},{default:a(()=>[s(se,{class:"article-uploader",action:`${l(O)}/admin/upload`,"show-file-list":!1,"before-upload":l(K),"on-success":l(G),method:"post",data:{userId:l(q)},name:"image","auto-upload":!1,ref_key:"uploadRef",ref:T,onChange:l(Q)},{default:a(()=>[t("div",Ke,[l(P)?ke((y(),N("img",Qe,null,512)),[[de,l(P)]]):(y(),N("div",Ye,[s(p,{class:"upload-icon"},{default:a(()=>[s(_)]),_:1}),e[27]||(e[27]=t("span",{class:"upload-text"},"支持的图片类型：jpeg、jpg、png、gif、webp",-1))]))])]),_:1},8,["action","before-upload","on-success","data","onChange"])]),_:1}),l(d)==="essay"?(y(),D(M,{key:2,label:"标签",prop:"label"},{default:a(()=>[s(Z,{modelValue:l(h).label,"onUpdate:modelValue":e[4]||(e[4]=n=>l(h).label=n),placeholder:"请输入标签"},null,8,["modelValue"])]),_:1})):$("",!0)]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title","before-close"])])}}}),st=Ce(Oe,[["__scopeId","data-v-3dfb7b19"]]);export{st as default};
