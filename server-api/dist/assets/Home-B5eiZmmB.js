import{e as f,u as re,P as O,A as ue,W as ce,X as pe,E as g,Y as ee,n as k,Z as me,_ as ge,$ as fe,i as ve,d as _e,c as P,f as t,a as o,w as s,U as ye,V as be,h as l,j as he,r,T as we,o as _,m as R,y as z,k as S,a0 as ke,a1 as le,z as M,t as Ce}from"./index-BDg1WjkS.js";import{_ as Ve}from"./_plugin-vue_export-helper-DlAUqK2U.js";function xe(B){var j;const I=ve(),y=f(null),D=re(),q=O(()=>D.user),C=f(!1),c=f("essay"),w=f(),v=f(""),F=f(0),A=f(0),V=f(0);let x=f(!1);const u=f({title:"",content:"",image:"",label:"",size:0}),{totalVisits:N,todayVisits:b}=pe;y.value=((j=q.value)==null?void 0:j.id)||null;let E=()=>{I.push("/wall/messages")},L=()=>{window.open("https://js.design/f/TrQmml?p=wwoaF4WR66&mode=design","_blank")},W=()=>{window.open("https://yike.design/","_blank")},$=()=>{window.open("https://github.com/ecaps1038/yike-design-dev","_blank")},G=()=>{I.push("/download"),console.log(1)};const H=()=>{B.value?B.value.submit():(console.error("uploadRef 未正确赋值"),g.error("上传组件未正确初始化，请稍后再试"))},Y=(a,d)=>{x.value=d.length>0},J=O(()=>({essay:"新增博客文章",photography:"新增摄影图库",notes:"新增随笔随记"})[c.value]),Q=O(()=>{const a={};return c.value!=="photography"&&(a.title=[{required:!0,message:"请输入标题",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],a.image=[{required:!0,message:"请上传图片",trigger:"change"}],a.content=[{required:!0,message:"请输入内容",trigger:"blur"},{min:5,max:500,message:"长度在 5 到 500 个字符",trigger:"blur"}]),c.value==="essay"&&(a.label=[{required:!0,message:"请输入标签",trigger:"blur"}]),a}),X=a=>{const i=["image/jpeg","image/png","image/webp","image/gif"].includes(a.type),m=a.size/1024/1024<2;return i||g.error("上传图片只能是 JPG 或 PNG 或 WEBP 或 GIF 格式!"),m||g.error("上传图片大小不能超过 2MB!"),y.value?(u.value.size=a.size,K(!0),i&&m):(g.error("用户ID未找到，请重新登录"),!1)},Z=(a,d)=>{v.value=`${ee}/image/${a.data.image}`,u.value.image=v.value,g.success("图片上传成功"),B.value.clearFiles(),x.value=!1},K=async(a=!1)=>{try{if(!v.value)return;const d=v.value.split("/");if(d.length===0){console.warn("imageUrl 格式不正确:",v.value);return}const i=d.pop();if(!i){console.warn("无法从 imageUrl 提取图片名称:",v.value);return}await k.delete(`${ee}/admin/upload/image/${i}`),v.value="",a?g.error("旧图片已删除, 已重新上传新图片"):g.info("已删除未使用的图片,如需重新上传,请点击上传按钮")}catch(d){console.error("删除图片失败:",d),g.error("删除失败")}};function e(a){c.value=a,C.value=!0}function p(){var a;K(!1),C.value=!1,u.value={title:"",content:"",label:"",image:"",size:0},(a=w.value)==null||a.resetFields()}async function h(){var a,d;try{await((a=w.value)==null?void 0:a.validate());let i={image:u.value.image,userId:y.value,size:u.value.size};c.value==="essay"?(i.title=u.value.title,i.content=u.value.content,i.label=u.value.label):c.value==="notes"&&(i.title=u.value.title,i.content=u.value.content);let m="";c.value==="essay"?(await k.post("/admin/article",i),m="创建博客文章成功"):c.value==="photography"?(await k.post("/admin/photography",i),m="创建摄影作品成功"):c.value==="notes"&&(await k.post("/admin/note",i),m="创建随笔随记成功"),C.value=!1,u.value={title:"",content:"",label:"",image:"",size:0},T(),g.success(m)}catch(i){console.error("创建失败",i),g.error("创建失败，请重试")}finally{(d=w.value)==null||d.resetFields()}}async function T(){try{const[a,d,i]=await Promise.all([k.get("/admin/article",{params:{userId:y.value}}),k.get("/admin/photography",{params:{userId:y.value}}),k.get("/admin/note",{params:{userId:y.value}})]);F.value=a.data.data.pagination.total,A.value=d.data.data.pagination.total,V.value=i.data.data.pagination.total}catch(a){console.error("获取数量失败",a),g.error("获取数量失败，请稍后再试")}}return ue(()=>{T()}),{wall:E,designdoc:L,official:W,github:$,download:G,ArrowRight:ce,todayVisits:b,totalVisits:N,submitUpload:H,handleSuccess:Z,contentTypes:[{type:"essay",title:"博客文章",description:"记录生活点滴",icon:me,iconColor:"text-primary",buttonType:"primary",countLabel:"篇文章"},{type:"photography",title:"摄影图库",description:"定格美好瞬间",icon:ge,iconColor:"text-success",buttonType:"success",countLabel:"张照片"},{type:"notes",title:"随笔随记",description:"随想随心记录",icon:fe,iconColor:"text-warning",buttonType:"warning",countLabel:"篇随笔"}],handleSubmit:h,handleClose:p,getTotalCount:a=>({essay:F.value,photography:A.value,notes:V.value})[a],handleAdd:e,beforeUpload:X,handleChange:Y,currentType:c,imageUrl:v,showUploadButton:x,dialogTitle:J,dialogVisible:C,formData:u,rules:Q,userId:y}}const Te={class:"home"},Ue={class:"main-container"},ze={class:"chat-room-card gradient-background"},Ie={class:"title"},De={class:"download"},Ne={class:"message-wall-card gradient-background"},Pe={class:"title"},Re={class:"Wall-doc"},Se={class:"yike-ui-card gradient-background"},Be={class:"title"},Fe={class:"action-buttons"},Ae={class:"statistics-container"},Le={class:"stats-cards"},$e={class:"card-header"},je={class:"stat-value"},Me={class:"card-header"},qe={class:"stat-value"},Ee={class:"content-cards"},We={class:"content-header"},Ge={class:"content-info"},He={class:"content-text"},Ye={class:"content-count"},Je={class:"count-number"},Qe={class:"count-label"},Xe={class:"upload-container"},Ze={key:0,class:"uploaded-image"},Ke={key:1,class:"upload-placeholder"},Oe={class:"dialog-footer"},et=_e({__name:"Home",setup(B){const I=f(null),{wall:y,designdoc:D,official:q,github:C,download:c,ArrowRight:w,todayVisits:v,totalVisits:F,contentTypes:A,currentType:V,imageUrl:x,showUploadButton:u,dialogVisible:N,formData:b,userId:E,submitUpload:L,handleSuccess:W,handleSubmit:$,handleClose:G,getTotalCount:H,handleAdd:Y,beforeUpload:J,handleChange:Q,dialogTitle:X,rules:Z}=xe(I);return(K,e)=>{const p=r("el-icon"),h=r("el-card"),T=r("el-carousel-item"),U=r("el-button"),te=r("el-carousel"),j=r("View"),a=r("Timer"),d=r("Plus"),i=r("el-input"),m=r("el-form-item"),oe=r("el-upload"),se=r("el-form"),ae=r("Upload"),ne=r("SuccessFilled"),ie=r("el-dialog"),de=we("lazy");return _(),P("div",Te,[t("div",Ue,[o(te,{class:"custom-carousel",interval:5e3,"indicator-position":"outside",width:"100%",height:"400px"},{default:s(()=>[o(T,null,{default:s(()=>[t("div",ze,[o(h,{shadow:"always",class:"full-width-card chat-room-card-content"},{default:s(()=>[t("div",Ie,[e[9]||(e[9]=t("h1",null,"Vue+Node.js",-1)),e[10]||(e[10]=t("h1",{style:{width:"350px"}},"0到1实现即时通讯聊天室",-1)),e[11]||(e[11]=t("p",{style:{"margin-top":"20px"}},"单聊 群聊",-1)),e[12]||(e[12]=t("p",null,"可发送文字 表情 图片 语音 位置....",-1)),e[13]||(e[13]=t("div",{class:"text-box"},[t("p",null," 如您对这个应用感兴趣,欢迎下载使用,当然对于需要查看设计稿和下载切图的同学,点击下方对应路口查阅。 ")],-1)),t("div",De,[t("span",{class:"down-load",onClick:e[0]||(e[0]=(...n)=>l(c)&&l(c)(...n))},"下载应用"),t("button",{onClick:e[1]||(e[1]=(...n)=>l(D)&&l(D)(...n)),class:"design-doc"},[e[8]||(e[8]=R(" 访问设计稿原型 ")),o(p,{size:10,color:"skyblue"},{default:s(()=>[o(l(w))]),_:1})])])])]),_:1})])]),_:1}),o(T,null,{default:s(()=>[t("div",Ne,[o(h,{shadow:"always",class:"full-width-card message-wall-content"},{default:s(()=>[t("div",Pe,[e[16]||(e[16]=t("h1",null,"一刻时光留言墙,留下你的足迹",-1)),e[17]||(e[17]=t("p",{style:{"margin-top":"20px"}},"当下的心情,就让他留在当下吧",-1)),e[18]||(e[18]=t("div",{class:"text-box"},[t("p",null," 如您对留言墙感兴趣，欢迎来留言。需要查看设计稿和下载切图的同学，点击下方设计稿入口查阅 ")],-1)),t("div",Re,[o(U,{class:"wall",onClick:l(y)},{default:s(()=>e[14]||(e[14]=[R("去留言")])),_:1},8,["onClick"]),o(U,{class:"design-doc",onClick:l(D)},{default:s(()=>[e[15]||(e[15]=R("访问设计稿原型 ")),o(p,{size:10,color:"skyblue"},{default:s(()=>[o(l(w))]),_:1})]),_:1},8,["onClick"])])])]),_:1})])]),_:1}),o(T,null,{default:s(()=>[t("div",Se,[o(h,{shadow:"always",class:"full-width-card yike-ui-card-content"},{default:s(()=>[t("div",Be,[e[21]||(e[21]=t("h1",null,"Yike Design",-1)),e[22]||(e[22]=t("p",null,"Vue3+Ts+Less 开发的前端UI框架",-1)),e[23]||(e[23]=t("div",{class:"text-box"},[t("p",{style:{"margin-top":"50px"}}," 一套简洁干净的前端UI框架。从源码出发，提供便捷的源码配置，单个组件自由组合成专属UI库，为服务于交互与展示。 ")],-1)),t("div",Fe,[o(U,{class:"official-address",onClick:l(q)},{default:s(()=>e[19]||(e[19]=[R("官方地址")])),_:1},8,["onClick"]),o(U,{onClick:l(C),class:"design-doc"},{default:s(()=>[e[20]||(e[20]=R(" github仓库 ")),o(p,{size:10,color:"skyblue"},{default:s(()=>[o(l(w))]),_:1})]),_:1},8,["onClick"])])])]),_:1})])]),_:1})]),_:1}),t("div",Ae,[e[26]||(e[26]=t("h2",{class:"section-title"},"数据模块",-1)),t("div",Le,[o(h,{class:"stat-card total-visits"},{header:s(()=>[t("div",$e,[o(p,null,{default:s(()=>[o(j)]),_:1}),e[24]||(e[24]=t("span",null,"总访问量",-1))])]),default:s(()=>[t("div",je,z(l(F)),1)]),_:1}),o(h,{class:"stat-card today-visits"},{header:s(()=>[t("div",Me,[o(p,null,{default:s(()=>[o(a)]),_:1}),e[25]||(e[25]=t("span",null,"今日访问",-1))])]),default:s(()=>[t("div",qe,z(l(v)),1)]),_:1})]),t("div",Ee,[(_(!0),P(ye,null,be(l(A),n=>(_(),S(h,{key:n.type,class:le(["content-card",n.type]),onClick:tt=>l(Y)(n.type)},{default:s(()=>[t("div",We,[t("div",Ge,[o(p,{size:24,class:le(n.iconColor)},{default:s(()=>[(_(),S(ke(n.icon)))]),_:2},1032,["class"]),t("div",He,[t("h3",null,z(n.title),1),t("p",null,z(n.description),1)])]),o(U,{type:n.buttonType,circle:"",class:"add-button"},{default:s(()=>[o(p,null,{default:s(()=>[o(d)]),_:1})]),_:2},1032,["type"])]),t("div",Ye,[t("span",Je,z(l(H)(n.type)),1),t("span",Qe,z(n.countLabel),1)])]),_:2},1032,["class","onClick"]))),128))])])]),o(ie,{modelValue:l(N),"onUpdate:modelValue":e[7]||(e[7]=n=>he(N)?N.value=n:null),title:l(X),width:"50%","before-close":l(G),"close-on-click-modal":!1},{footer:s(()=>[t("span",Oe,[l(u)?(_(),P("div",{key:0,class:"avatar-upload",onClick:e[5]||(e[5]=(...n)=>l(L)&&l(L)(...n))},[o(p,null,{default:s(()=>[o(ae)]),_:1}),e[28]||(e[28]=t("span",null,"上传",-1))])):M("",!0),t("div",{class:"avatar-upload",type:"primary",onClick:e[6]||(e[6]=(...n)=>l($)&&l($)(...n))},[o(p,null,{default:s(()=>[o(ne)]),_:1}),e[29]||(e[29]=t("span",null,"保存",-1))])])]),default:s(()=>[o(se,{ref:"formRef",model:l(b),rules:l(Z),"label-width":"80px",class:"add-form"},{default:s(()=>[l(V)!=="photography"?(_(),S(m,{key:0,label:"标题",prop:"title"},{default:s(()=>[o(i,{modelValue:l(b).title,"onUpdate:modelValue":e[2]||(e[2]=n=>l(b).title=n),placeholder:"请输入标题"},null,8,["modelValue"])]),_:1})):M("",!0),l(V)!=="photography"?(_(),S(m,{key:1,label:"内容",prop:"content"},{default:s(()=>[o(i,{modelValue:l(b).content,"onUpdate:modelValue":e[3]||(e[3]=n=>l(b).content=n),type:"textarea",rows:4,placeholder:"请输入内容"},null,8,["modelValue"])]),_:1})):M("",!0),o(m,{label:"上传图库",prop:"image"},{default:s(()=>[o(oe,{class:"article-uploader",action:`${l(ee)}/admin/upload`,"show-file-list":!1,"before-upload":l(J),"on-success":l(W),method:"post",data:{userId:l(E)},name:"image","auto-upload":!1,ref_key:"uploadRef",ref:I,onChange:l(Q)},{default:s(()=>[t("div",Xe,[l(x)?Ce((_(),P("img",Ze,null,512)),[[de,l(x)]]):(_(),P("div",Ke,[o(p,{class:"upload-icon"},{default:s(()=>[o(d)]),_:1}),e[27]||(e[27]=t("span",{class:"upload-text"},"支持的图片类型：jpeg、jpg、png、gif、webp",-1))]))])]),_:1},8,["action","before-upload","on-success","data","onChange"])]),_:1}),l(V)==="essay"?(_(),S(m,{key:2,label:"标签",prop:"label"},{default:s(()=>[o(i,{modelValue:l(b).label,"onUpdate:modelValue":e[4]||(e[4]=n=>l(b).label=n),placeholder:"请输入标签"},null,8,["modelValue"])]),_:1})):M("",!0)]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title","before-close"])])}}}),st=Ve(et,[["__scopeId","data-v-3dfb7b19"]]);export{st as default};
